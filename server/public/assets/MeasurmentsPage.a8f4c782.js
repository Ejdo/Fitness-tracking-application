import{Q as s}from"./QBtn.d1f140d8.js";import{Q as C,a as b}from"./QTable.77361f1e.js";import{Q as h,a as d}from"./QCard.6354ec78.js";import{Q as M}from"./QInput.d4f7eab6.js";import{u as _,Q as k}from"./measurments-store.b4855bd9.js";import{k as V,h as x}from"./QDialog.5f70cc3d.js";import{Q,C as S}from"./ClosePopup.d1c8af6a.js";import{e as w,Q as q}from"./export-file.36fee849.js";import{u as U}from"./methods-store.1457f6eb.js";import{a as T}from"./axios.cbf05cdc.js";import{_ as D,y as c,g as I,o as A,H as j,q as a,w as o,I as p,E as B}from"./index.10d3f647.js";import"./dom.543f5459.js";import"./use-dark.f3ad74a0.js";import"./scroll.fe020b7e.js";import"./use-key-composition.28abccc9.js";import"./focus-manager.387b0375.js";import"./QCheckbox.50ec8d59.js";const y=[{name:"id",align:"left",label:"ID",field:"id",sortable:!0},{name:"type",align:"left",label:"Type",field:"type",sortable:!0},{name:"date",align:"left",label:"Date",field:"date",sortable:!0},{name:"value",align:"left",label:"Value",field:"value",sortable:!0},{name:"method_id",align:"left",label:"Method ID",field:"method_id"},{name:"method_name",align:"left",label:"Method Name",field:"method_name"}],E=["V\xE1ha","Spodn\xFD tlak","Horn\xFD tlak"];function g(m,e,i){let t=e!==void 0?e(m,i):m;return t=t==null?"":String(t),t=t.split('"').join('""'),`"${t}"`}const N={data(){return{measurment:{type:"",date:"2022/12/06",value:0,method_id:null}}},computed:{methodID(){return this.method.split(" ")[0]},authToken(){return T.getToken()}},setup(){const m=c(!1),e=c(!1),i=_(),t=U(),r=c([]),f=I(()=>i.getMeasurments);return{measurmentsStore:i,methodsStore:t,measurments:f,columns:y,measurmentTypes:E,card:m,uploadCard:e,selected:r,method:c(""),currentURL:"",createMeasurment(){t.refreshMethods(),m.value=!0},deleteMeasurments(){var l=r.value.map(v=>v.id);this.measurmentsStore.deleteMeasurments(l)},exportTable(){const l=[y.map(u=>g(u.name))].concat(this.measurments.map(u=>y.map(n=>g(typeof n.field=="function"?n.field(u):u[n.field===void 0?n.name:n.field],n.format,u)).join(","))).join(`\r
`),v=w("table-export.csv",l,"text/csv");console.log(v)}}},mounted(){this.measurmentsStore.refreshMeasurments()}},P={class:"q-pa-xl"},H=p("div",{class:"row no-wrap items-center"},[p("div",{class:"col text-h6 ellipsis"}," Add Measurment ")],-1),z={class:"row content-center"},L=p("div",{class:"row no-wrap items-center"},[p("div",{class:"col text-h6 ellipsis"}," Upload CSV ")],-1);function R(m,e,i,t,r,f){return A(),j("div",P,[a(C,{title:"Measurments",rows:t.measurments,columns:t.columns,"row-key":"id","virtual-scroll":"",style:{"max-height":"400px"},class:"my-sticky-virtscroll-table",selection:"multiple",selected:t.selected,"onUpdate:selected":e[4]||(e[4]=l=>t.selected=l)},{"no-data":o(()=>[a(s,{color:"primary",label:"Add measurment",onClick:t.createMeasurment,class:"q-my-md q-mr-md"},null,8,["onClick"]),a(s,{color:"primary","icon-right":"file_upload",label:"Import csv",onClick:e[0]||(e[0]=l=>t.uploadCard=!0),"no-caps":""})]),bottom:o(()=>[a(s,{color:"primary",label:"Add measurment",onClick:t.createMeasurment,class:"q-my-md q-mr-md"},null,8,["onClick"]),a(s,{color:"primary",label:"Delete measurments",onClick:e[1]||(e[1]=l=>t.deleteMeasurments()),class:"q-my-md q-mr-md"}),a(s,{color:"primary","icon-right":"file_download",label:"Export to csv",onClick:e[2]||(e[2]=l=>t.exportTable()),"no-caps":"",class:"q-my-md q-mr-md"}),a(s,{color:"primary","icon-right":"file_upload",label:"Import csv",onClick:e[3]||(e[3]=l=>t.uploadCard=!0),"no-caps":""})]),_:1},8,["rows","columns","selected"]),a(V,{modelValue:t.card,"onUpdate:modelValue":e[10]||(e[10]=l=>t.card=l)},{default:o(()=>[a(h,{class:"my-card"},{default:o(()=>[a(d,null,{default:o(()=>[H]),_:1}),a(d,null,{default:o(()=>[p("div",z,[a(b,{outlined:"",modelValue:r.measurment.type,"onUpdate:modelValue":e[5]||(e[5]=l=>r.measurment.type=l),options:t.measurmentTypes,class:"q-pr-sm col",label:"Type"},null,8,["modelValue","options"]),a(M,{outlined:"",modelValue:r.measurment.value,"onUpdate:modelValue":e[6]||(e[6]=l=>r.measurment.value=l),type:"number",class:"col",label:"Value"},null,8,["modelValue"])])]),_:1}),a(d,{class:"row justify-center"},{default:o(()=>[a(k,{modelValue:r.measurment.date,"onUpdate:modelValue":e[7]||(e[7]=l=>r.measurment.date=l),minimal:""},null,8,["modelValue"])]),_:1}),a(d,null,{default:o(()=>[a(b,{outlined:"",modelValue:r.measurment.method_id,"onUpdate:modelValue":e[8]||(e[8]=l=>r.measurment.method_id=l),options:t.methodsStore.getMethods.map(l=>l.id+" "+l.name),class:"row-12",label:"Method"},null,8,["modelValue","options"])]),_:1}),a(x),a(Q,{align:"right"},{default:o(()=>[B(a(s,{flat:"",color:"primary",label:"Add",onClick:e[9]||(e[9]=l=>t.measurmentsStore.addMeasurment(this.measurment))},null,512),[[S]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(V,{modelValue:t.uploadCard,"onUpdate:modelValue":e[12]||(e[12]=l=>t.uploadCard=l)},{default:o(()=>[a(h,{class:"my-card"},{default:o(()=>[a(d,null,{default:o(()=>[L]),_:1}),a(d,null,{default:o(()=>[a(q,{style:{"max-width":"300px"},url:"http://localhost:8080/measurments/import",headers:[{name:"Authorization",value:f.authToken}],label:"Select a CSV file",multiple:"","auto-upload":"",accept:".csv","max-files":"1",onUploaded:e[11]||(e[11]=l=>t.measurmentsStore.refreshMeasurments())},null,8,["headers"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var me=D(N,[["render",R]]);export{me as default};
